---
title: "Part A - Lego Analysis"
format: pdf
editor: visual
---

## Analysis of Lego

```{r}
#| message: false
#| warning: false
# Loading libraries

library(tidyverse)
library(tidytuesdayR)
library(ggplot2)
library(scales)
```

Reading in dataset

```{r}
#| message: false
#| warning: false

# Read data from tidytuesday
tuesdata = tidytuesdayR::tt_load('2022-09-06')

for (name in names(tuesdata)) 
{var_name = gsub("\\.csv$", "", name) 
  assign(var_name, tuesdata[[name]])}

rm(tuesdata)
```

Explore data

```{r}
head(colors)
head(elements)
head(inventories)
head(inventory_minifigs)
head(inventory_parts)
head(inventory_sets)
head(minifigs)
head(part_categories)
head(part_relationships)
head(parts)
head(sets)
head(themes)
```

Considering the popularity of Lego, which is the most popular and the least popular themes of Lego and how many parts did they have median

Methodology:\
\
Many sets did not have a number of parts and were either 0 or NA, which affected the data analysis and data manipulation. What we've done is filtered only the ones that we know of how many parts as if they are not documented then there is no point in analysing it.

```{r}
#| message: false
#| warning: false

# Joining sets with themes and filtering out the sets with no parts due to error in data collection
set_themes = sets |>
  filter(!is.na(num_parts) & num_parts >0) |>
  left_join(themes |>
              select(id, theme_name = name), 
              by = c(theme_id = "id"))
```

```{r}
#| message: false
#| warning: false

# Finding out the most popular themes
most_popular = set_themes |>
  group_by(theme_name) |>
  summarize(total_sets = n(),
            median_parts = round(median(num_parts, na.rm = TRUE)),
            .groups = "drop") |>
  arrange(desc(total_sets)) |>
  head(20) |>
  ggplot(aes(x = total_sets, y = reorder(theme_name, total_sets))) +
  geom_bar(stat = "identity", aes(fill = median_parts)) +
  geom_text(aes(label = median_parts, 
                x = total_sets + 5),
            hjust = 0, size = 3.2) +
  scale_fill_gradient(low = "#00648C", high = "#00BC8C", limits = c(0, 2600)) +
  labs(fill = "Median parts",
       title = "All time most popular lego themes with median parts",
       x = "Total number of sets",
       y = "Theme") +
  theme_minimal()

most_popular
```

```{r}
#| message: false
#| warning: false

# Finding out the least popular themes
least_popular = set_themes |>
  group_by(theme_name) |>
  summarize(total_sets = n(),
            median_parts = round(median(num_parts, na.rm = TRUE)),
            .groups = "drop") |>
  arrange(desc(total_sets)) |>
  tail(20) |>
  ggplot(aes(x = total_sets, y = reorder(theme_name, total_sets))) +
  geom_bar(stat = "identity", aes(fill = median_parts)) +
  geom_text(aes(label = median_parts),
            hjust = 0, size = 3.2) +
  scale_fill_gradient(low = "#00648C", high = "#00BC8C", limits = c(0, 2600)) +
  labs(fill = "Median parts",
       title = "All time least popular lego themes with median parts",
       x = "Total number of sets",
       y = "Theme")+ 
  xlim(0,4)+
  theme_minimal()

least_popular
```

### Most Popular LEGO Themes

1.  Technic ranks as the most popular theme by total number of sets (\~850) and features a high median part count of 846, indicating complex, advanced builds.

2.  Star Wars follows with nearly 700 sets and a median of 648 parts, combining broad fan appeal with high build complexity.

3.  Other popular themes like Friends, Ninjago, and Classic Town have moderate median part counts (50–80), suggesting simpler, more accessible builds for younger audiences.

4.  While Gear and Basic Set were popular in total count in earlier analyses, they show much lower median parts, indicating smaller, simpler sets.

### Least Popular LEGO Themes

1.  Themes like Zooters, X-Men, Wolfpack, and Stranger Things each have fewer than 4 sets, clearly making them least popular.

2.  Surprisingly, some of these rare themes have very high median part counts, such as:

    -   Ghostbusters (2599 parts)

    -   Sculptures (1850 parts)

    -   Fantastic Beasts (413 parts)

3.  These themes likely target niche or adult builders, offering large, detailed sets but lacking broad market traction.

4.  Themes like Mini (1356 sets) are high in count but low in median parts, suggesting mass-produced, small builds.

### Conclusion

Popular themes balance set quantity and moderate complexity to reach wide audiences. Unpopular themes may offer greater complexity, but limited releases or niche targeting reduce their market impact. LEGO’s strategy spans both mass-market series and collector-grade sets, reflecting its diverse user base and flexible product design.

```{r}
theme_name_summary = set_themes |> 
  group_by(theme_name) |>
  summarize(n_sets = n(), 
            median_parts = median(num_parts)) |>
  arrange(desc(n_sets)) |> 
  filter(n_sets >= 100)

theme_name_summary
```

Seeing the trends of Lego sets over the years, how complex have the Lego sets become.

```{r}


part_year = set_themes |>
  group_by(year) |>
  summarise(median_parts = median(num_parts, na.rm = TRUE), .groups = "drop") |>
  ggplot(aes(x = year, y = median_parts)) +
  geom_line(color = "#00BC8C", linewidth = 1) +
  geom_point(color = "black") +
  geom_smooth(method = "loess", se = FALSE, color = "red", linetype = "dashed") +
  labs(title = "Median number of parts over the years",
       x = "Year",
       y = "Median parts per set")+
  theme_minimal() 

part_year
```

Which sets have the most parts

```{r}

```

### Analysis: Complexity of LEGO Sets Over the Years

1.  Early Years (1950s–1960s): Irregular and Experimental

    The 1950s and early 1960s show sharp fluctuations in median part counts, including extreme spikes (e.g., one year with over 250 parts). This likely reflects LEGO's early experimentation with set design before standardizing product lines.

2.  1970s–1990s: Gradual Stabilization

    During these decades, the median number of parts remained relatively stable, averaging between 50 and 100 parts per set. This suggests LEGO was producing simpler sets aimed at children, focusing more on quantity and playability than complexity.

3.  2000s–2010s: Moderate Increase in Complexity

    A slight upward trend appears in the 2000s, with median parts slowly rising year over year. This reflects LEGO’s expansion into more diverse themes (e.g., Star Wars, Technic) and the introduction of more detailed sets, appealing to both children and adult fans.

4.  2020–2023: Sharp Rise in Complexity

    In the most recent years, the median number of parts has increased significantly, exceeding 150 parts per set in 2023. This may be due to the growing popularity of large-scale sets, modular buildings, and collector-focused themes.

5.  Trendline Interpretation

    The red dashed trendline confirms a clear long-term upward trajectory in set complexity. Despite some fluctuations, the overall pattern shows LEGO sets have consistently become more complex over the decades.

### Conclusion

LEGO sets have evolved from basic, simple designs into intricate and detail-rich models. The increasing median part count, especially after 2010, demonstrates a deliberate shift toward higher complexity, aligning with the rise of adult fans and the collector market.
